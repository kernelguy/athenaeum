<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exception Handling | Athenaeum</title>
    <meta name="description" content="How to use setup exception handling">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/athenaeum/assets/css/0.styles.17fe52c7.css" as="style"><link rel="preload" href="/athenaeum/assets/js/app.7535e502.js" as="script"><link rel="preload" href="/athenaeum/assets/js/2.ee1d810c.js" as="script"><link rel="preload" href="/athenaeum/assets/js/36.c8a6a270.js" as="script"><link rel="prefetch" href="/athenaeum/assets/js/10.d2f1ffb0.js"><link rel="prefetch" href="/athenaeum/assets/js/100.0525650b.js"><link rel="prefetch" href="/athenaeum/assets/js/101.e9548612.js"><link rel="prefetch" href="/athenaeum/assets/js/102.31cfbf56.js"><link rel="prefetch" href="/athenaeum/assets/js/103.b4426d72.js"><link rel="prefetch" href="/athenaeum/assets/js/104.c7f230f4.js"><link rel="prefetch" href="/athenaeum/assets/js/105.809eafd2.js"><link rel="prefetch" href="/athenaeum/assets/js/106.6f7c51f4.js"><link rel="prefetch" href="/athenaeum/assets/js/107.79bb5258.js"><link rel="prefetch" href="/athenaeum/assets/js/108.ef57c0b1.js"><link rel="prefetch" href="/athenaeum/assets/js/109.9e5193e3.js"><link rel="prefetch" href="/athenaeum/assets/js/11.4d4e447d.js"><link rel="prefetch" href="/athenaeum/assets/js/110.eb6f409a.js"><link rel="prefetch" href="/athenaeum/assets/js/111.5b151c74.js"><link rel="prefetch" href="/athenaeum/assets/js/112.0b7475f9.js"><link rel="prefetch" href="/athenaeum/assets/js/113.ef90e127.js"><link rel="prefetch" href="/athenaeum/assets/js/114.b4740ac1.js"><link rel="prefetch" href="/athenaeum/assets/js/115.f4b8c0bd.js"><link rel="prefetch" href="/athenaeum/assets/js/116.2e9d3d77.js"><link rel="prefetch" href="/athenaeum/assets/js/117.1e7de086.js"><link rel="prefetch" href="/athenaeum/assets/js/118.04d22e21.js"><link rel="prefetch" href="/athenaeum/assets/js/119.9a1b999a.js"><link rel="prefetch" href="/athenaeum/assets/js/12.88d68faa.js"><link rel="prefetch" href="/athenaeum/assets/js/120.2a0ae6aa.js"><link rel="prefetch" href="/athenaeum/assets/js/121.2eb8bcc5.js"><link rel="prefetch" href="/athenaeum/assets/js/122.97dd4c18.js"><link rel="prefetch" href="/athenaeum/assets/js/123.97f57478.js"><link rel="prefetch" href="/athenaeum/assets/js/124.66d61dcc.js"><link rel="prefetch" href="/athenaeum/assets/js/125.2659d5a1.js"><link rel="prefetch" href="/athenaeum/assets/js/126.2cb41ef0.js"><link rel="prefetch" href="/athenaeum/assets/js/127.a833dab3.js"><link rel="prefetch" href="/athenaeum/assets/js/128.8c02ceae.js"><link rel="prefetch" href="/athenaeum/assets/js/129.767f8ed6.js"><link rel="prefetch" href="/athenaeum/assets/js/13.8a3d7dcd.js"><link rel="prefetch" href="/athenaeum/assets/js/130.bf45cd81.js"><link rel="prefetch" href="/athenaeum/assets/js/131.af5420ad.js"><link rel="prefetch" href="/athenaeum/assets/js/132.078c0549.js"><link rel="prefetch" href="/athenaeum/assets/js/133.4d91e8c9.js"><link rel="prefetch" href="/athenaeum/assets/js/134.993b5157.js"><link rel="prefetch" href="/athenaeum/assets/js/135.55f05f57.js"><link rel="prefetch" href="/athenaeum/assets/js/136.fd79e93b.js"><link rel="prefetch" href="/athenaeum/assets/js/137.b9da1b32.js"><link rel="prefetch" href="/athenaeum/assets/js/138.6e5367ca.js"><link rel="prefetch" href="/athenaeum/assets/js/139.3f622eff.js"><link rel="prefetch" href="/athenaeum/assets/js/14.d2a6f6fc.js"><link rel="prefetch" href="/athenaeum/assets/js/140.49748188.js"><link rel="prefetch" href="/athenaeum/assets/js/141.22c3f316.js"><link rel="prefetch" href="/athenaeum/assets/js/142.eb9376fe.js"><link rel="prefetch" href="/athenaeum/assets/js/143.66555131.js"><link rel="prefetch" href="/athenaeum/assets/js/144.5f8663c7.js"><link rel="prefetch" href="/athenaeum/assets/js/145.08302574.js"><link rel="prefetch" href="/athenaeum/assets/js/146.e959c6ec.js"><link rel="prefetch" href="/athenaeum/assets/js/147.db228968.js"><link rel="prefetch" href="/athenaeum/assets/js/148.242b0182.js"><link rel="prefetch" href="/athenaeum/assets/js/149.34e7d515.js"><link rel="prefetch" href="/athenaeum/assets/js/15.4b84c29c.js"><link rel="prefetch" href="/athenaeum/assets/js/150.34c8d9ee.js"><link rel="prefetch" href="/athenaeum/assets/js/151.e00a04c3.js"><link rel="prefetch" href="/athenaeum/assets/js/152.a078fbd6.js"><link rel="prefetch" href="/athenaeum/assets/js/153.b8fe75f7.js"><link rel="prefetch" href="/athenaeum/assets/js/154.7a5d6099.js"><link rel="prefetch" href="/athenaeum/assets/js/155.bd6e522a.js"><link rel="prefetch" href="/athenaeum/assets/js/156.f1814a2b.js"><link rel="prefetch" href="/athenaeum/assets/js/157.36fdbcb7.js"><link rel="prefetch" href="/athenaeum/assets/js/158.62d7623c.js"><link rel="prefetch" href="/athenaeum/assets/js/159.c576eacc.js"><link rel="prefetch" href="/athenaeum/assets/js/16.6457081a.js"><link rel="prefetch" href="/athenaeum/assets/js/160.ab0591d4.js"><link rel="prefetch" href="/athenaeum/assets/js/161.6da7a252.js"><link rel="prefetch" href="/athenaeum/assets/js/162.0970ff8e.js"><link rel="prefetch" href="/athenaeum/assets/js/163.35c6a764.js"><link rel="prefetch" href="/athenaeum/assets/js/164.1be6a929.js"><link rel="prefetch" href="/athenaeum/assets/js/165.72e09ab8.js"><link rel="prefetch" href="/athenaeum/assets/js/166.6a9f3ea3.js"><link rel="prefetch" href="/athenaeum/assets/js/167.2afd476d.js"><link rel="prefetch" href="/athenaeum/assets/js/168.526506a0.js"><link rel="prefetch" href="/athenaeum/assets/js/169.8bd787fa.js"><link rel="prefetch" href="/athenaeum/assets/js/17.82f86ed2.js"><link rel="prefetch" href="/athenaeum/assets/js/170.0dd2768e.js"><link rel="prefetch" href="/athenaeum/assets/js/171.2863e6ad.js"><link rel="prefetch" href="/athenaeum/assets/js/172.567aa979.js"><link rel="prefetch" href="/athenaeum/assets/js/173.58beef8e.js"><link rel="prefetch" href="/athenaeum/assets/js/174.584110b6.js"><link rel="prefetch" href="/athenaeum/assets/js/175.eb4b6f0a.js"><link rel="prefetch" href="/athenaeum/assets/js/176.10890d2e.js"><link rel="prefetch" href="/athenaeum/assets/js/177.9229ebe1.js"><link rel="prefetch" href="/athenaeum/assets/js/178.bdc81009.js"><link rel="prefetch" href="/athenaeum/assets/js/179.d03159b3.js"><link rel="prefetch" href="/athenaeum/assets/js/18.7585aa32.js"><link rel="prefetch" href="/athenaeum/assets/js/180.13f6c80d.js"><link rel="prefetch" href="/athenaeum/assets/js/181.a44645f1.js"><link rel="prefetch" href="/athenaeum/assets/js/182.9af45546.js"><link rel="prefetch" href="/athenaeum/assets/js/183.d0ef949a.js"><link rel="prefetch" href="/athenaeum/assets/js/184.3bab184f.js"><link rel="prefetch" href="/athenaeum/assets/js/185.87ece964.js"><link rel="prefetch" href="/athenaeum/assets/js/186.11b4dbc0.js"><link rel="prefetch" href="/athenaeum/assets/js/187.0b6569e5.js"><link rel="prefetch" href="/athenaeum/assets/js/188.c61d3e82.js"><link rel="prefetch" href="/athenaeum/assets/js/189.7c95bbb5.js"><link rel="prefetch" href="/athenaeum/assets/js/19.bd7156a2.js"><link rel="prefetch" href="/athenaeum/assets/js/190.eb60018f.js"><link rel="prefetch" href="/athenaeum/assets/js/191.404a3cfc.js"><link rel="prefetch" href="/athenaeum/assets/js/192.3b12471d.js"><link rel="prefetch" href="/athenaeum/assets/js/193.db940d0e.js"><link rel="prefetch" href="/athenaeum/assets/js/194.2cca149a.js"><link rel="prefetch" href="/athenaeum/assets/js/195.a8161e5b.js"><link rel="prefetch" href="/athenaeum/assets/js/196.eb930eb8.js"><link rel="prefetch" href="/athenaeum/assets/js/20.2fd6ad98.js"><link rel="prefetch" href="/athenaeum/assets/js/21.dad64317.js"><link rel="prefetch" href="/athenaeum/assets/js/22.19a127b8.js"><link rel="prefetch" href="/athenaeum/assets/js/23.3571ac7f.js"><link rel="prefetch" href="/athenaeum/assets/js/24.f86056db.js"><link rel="prefetch" href="/athenaeum/assets/js/25.1667941a.js"><link rel="prefetch" href="/athenaeum/assets/js/26.a8f2ed92.js"><link rel="prefetch" href="/athenaeum/assets/js/27.67cddf3e.js"><link rel="prefetch" href="/athenaeum/assets/js/28.f9070523.js"><link rel="prefetch" href="/athenaeum/assets/js/29.ba8fc8b4.js"><link rel="prefetch" href="/athenaeum/assets/js/3.9b6fc46a.js"><link rel="prefetch" href="/athenaeum/assets/js/30.088e6ec9.js"><link rel="prefetch" href="/athenaeum/assets/js/31.2883051e.js"><link rel="prefetch" href="/athenaeum/assets/js/32.1a54a371.js"><link rel="prefetch" href="/athenaeum/assets/js/33.70a4ff7b.js"><link rel="prefetch" href="/athenaeum/assets/js/34.cfc87542.js"><link rel="prefetch" href="/athenaeum/assets/js/35.9419dbf6.js"><link rel="prefetch" href="/athenaeum/assets/js/37.77d8ac3d.js"><link rel="prefetch" href="/athenaeum/assets/js/38.c2b305e8.js"><link rel="prefetch" href="/athenaeum/assets/js/39.c2480ecf.js"><link rel="prefetch" href="/athenaeum/assets/js/4.2d1173b6.js"><link rel="prefetch" href="/athenaeum/assets/js/40.02b941c5.js"><link rel="prefetch" href="/athenaeum/assets/js/41.7a94329c.js"><link rel="prefetch" href="/athenaeum/assets/js/42.419b4f53.js"><link rel="prefetch" href="/athenaeum/assets/js/43.e9e39c88.js"><link rel="prefetch" href="/athenaeum/assets/js/44.2e2bc404.js"><link rel="prefetch" href="/athenaeum/assets/js/45.9671aa4a.js"><link rel="prefetch" href="/athenaeum/assets/js/46.27f3f351.js"><link rel="prefetch" href="/athenaeum/assets/js/47.62cb623a.js"><link rel="prefetch" href="/athenaeum/assets/js/48.278e6f20.js"><link rel="prefetch" href="/athenaeum/assets/js/49.1726c4cf.js"><link rel="prefetch" href="/athenaeum/assets/js/5.ac60d950.js"><link rel="prefetch" href="/athenaeum/assets/js/50.88e487b1.js"><link rel="prefetch" href="/athenaeum/assets/js/51.96a10448.js"><link rel="prefetch" href="/athenaeum/assets/js/52.45587a25.js"><link rel="prefetch" href="/athenaeum/assets/js/53.daf3cdce.js"><link rel="prefetch" href="/athenaeum/assets/js/54.196427d3.js"><link rel="prefetch" href="/athenaeum/assets/js/55.d4239199.js"><link rel="prefetch" href="/athenaeum/assets/js/56.ffe58fd2.js"><link rel="prefetch" href="/athenaeum/assets/js/57.c17eab40.js"><link rel="prefetch" href="/athenaeum/assets/js/58.b69be4fa.js"><link rel="prefetch" href="/athenaeum/assets/js/59.31c31d6d.js"><link rel="prefetch" href="/athenaeum/assets/js/6.5ac06262.js"><link rel="prefetch" href="/athenaeum/assets/js/60.90e839c2.js"><link rel="prefetch" href="/athenaeum/assets/js/61.e965fc18.js"><link rel="prefetch" href="/athenaeum/assets/js/62.1bb1f1f0.js"><link rel="prefetch" href="/athenaeum/assets/js/63.bbf9ba08.js"><link rel="prefetch" href="/athenaeum/assets/js/64.64b3f7de.js"><link rel="prefetch" href="/athenaeum/assets/js/65.a0677f29.js"><link rel="prefetch" href="/athenaeum/assets/js/66.e16d734b.js"><link rel="prefetch" href="/athenaeum/assets/js/67.f1b08979.js"><link rel="prefetch" href="/athenaeum/assets/js/68.d1c9b93e.js"><link rel="prefetch" href="/athenaeum/assets/js/69.457cb17e.js"><link rel="prefetch" href="/athenaeum/assets/js/7.421b0877.js"><link rel="prefetch" href="/athenaeum/assets/js/70.7d6f7a73.js"><link rel="prefetch" href="/athenaeum/assets/js/71.651826d6.js"><link rel="prefetch" href="/athenaeum/assets/js/72.26c5d425.js"><link rel="prefetch" href="/athenaeum/assets/js/73.448672c0.js"><link rel="prefetch" href="/athenaeum/assets/js/74.1ce03d12.js"><link rel="prefetch" href="/athenaeum/assets/js/75.392135f4.js"><link rel="prefetch" href="/athenaeum/assets/js/76.c921392f.js"><link rel="prefetch" href="/athenaeum/assets/js/77.c4b68c7b.js"><link rel="prefetch" href="/athenaeum/assets/js/78.bd047c45.js"><link rel="prefetch" href="/athenaeum/assets/js/79.51a81e94.js"><link rel="prefetch" href="/athenaeum/assets/js/8.9bdcdda0.js"><link rel="prefetch" href="/athenaeum/assets/js/80.07cf1225.js"><link rel="prefetch" href="/athenaeum/assets/js/81.2c9b9b77.js"><link rel="prefetch" href="/athenaeum/assets/js/82.6f95f3d5.js"><link rel="prefetch" href="/athenaeum/assets/js/83.f5897638.js"><link rel="prefetch" href="/athenaeum/assets/js/84.78e19ece.js"><link rel="prefetch" href="/athenaeum/assets/js/85.35e0e510.js"><link rel="prefetch" href="/athenaeum/assets/js/86.d2a0c4cb.js"><link rel="prefetch" href="/athenaeum/assets/js/87.db0a7e06.js"><link rel="prefetch" href="/athenaeum/assets/js/88.7a6c1f7d.js"><link rel="prefetch" href="/athenaeum/assets/js/89.38372555.js"><link rel="prefetch" href="/athenaeum/assets/js/9.b5860216.js"><link rel="prefetch" href="/athenaeum/assets/js/90.f5a28533.js"><link rel="prefetch" href="/athenaeum/assets/js/91.b086b5e6.js"><link rel="prefetch" href="/athenaeum/assets/js/92.b131e058.js"><link rel="prefetch" href="/athenaeum/assets/js/93.20e94e4c.js"><link rel="prefetch" href="/athenaeum/assets/js/94.4b7c18b3.js"><link rel="prefetch" href="/athenaeum/assets/js/95.2d57b18f.js"><link rel="prefetch" href="/athenaeum/assets/js/96.a72a1ca6.js"><link rel="prefetch" href="/athenaeum/assets/js/97.a084bbf1.js"><link rel="prefetch" href="/athenaeum/assets/js/98.211c3e0f.js"><link rel="prefetch" href="/athenaeum/assets/js/99.7835b3f9.js">
    <link rel="stylesheet" href="/athenaeum/assets/css/0.styles.17fe52c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/athenaeum/" class="home-link router-link-active"><!----> <span class="site-name">Athenaeum</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/athenaeum/archive/current/" class="nav-link router-link-active">
  Packages
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archive" class="dropdown-title"><span class="title">Archive</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/athenaeum/archive/current/" class="nav-link router-link-active">
  current
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v3x/" class="nav-link">
  v3.x
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v2x/" class="nav-link">
  v2.x
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v1x/" class="nav-link">
  v1.x
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/aedart/athenaeum/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/aedart/athenaeum" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/athenaeum/archive/current/" class="nav-link router-link-active">
  Packages
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archive" class="dropdown-title"><span class="title">Archive</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/athenaeum/archive/current/" class="nav-link router-link-active">
  current
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v3x/" class="nav-link">
  v3.x
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v2x/" class="nav-link">
  v2.x
</a></li><li class="dropdown-item"><!----> <a href="/athenaeum/archive/v1x/" class="nav-link">
  v1.x
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/aedart/athenaeum/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/aedart/athenaeum" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Version 4.x</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Circuits</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Config</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Console</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Container</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Core</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/athenaeum/archive/current/core/" class="sidebar-link">Athenaeum Core Application</a></li><li><a href="/athenaeum/archive/current/core/prerequisite.html" class="sidebar-link">Prerequisite</a></li><li><a href="/athenaeum/archive/current/core/install.html" class="sidebar-link">How to install</a></li><li><a href="/athenaeum/archive/current/core/integration.html" class="sidebar-link">Integration</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Usage</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/athenaeum/archive/current/core/usage/" class="sidebar-link">Configuration</a></li><li><a href="/athenaeum/archive/current/core/usage/providers.html" class="sidebar-link">Service Providers</a></li><li><a href="/athenaeum/archive/current/core/usage/container.html" class="sidebar-link">Service Container</a></li><li><a href="/athenaeum/archive/current/core/usage/events.html" class="sidebar-link">Events</a></li><li><a href="/athenaeum/archive/current/core/usage/cache.html" class="sidebar-link">Caching</a></li><li><a href="/athenaeum/archive/current/core/usage/logging.html" class="sidebar-link">Logging</a></li><li><a href="/athenaeum/archive/current/core/usage/console.html" class="sidebar-link">Console</a></li><li><a href="/athenaeum/archive/current/core/usage/tasks.html" class="sidebar-link">Task Scheduling</a></li><li><a href="/athenaeum/archive/current/core/usage/exceptions.html" class="active sidebar-link">Exception Handling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#laravel-s-exception-handling" class="sidebar-link">Laravel's Exception Handling?</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#how-it-works" class="sidebar-link">How it Works</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#prerequisite" class="sidebar-link">Prerequisite</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#enabling-exception-handling" class="sidebar-link">Enabling Exception Handling</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#last-resort-handler" class="sidebar-link">&quot;Last Resort&quot; Handler</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#reporting" class="sidebar-link">Reporting</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#handler-in-action" class="sidebar-link">Handler In Action</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#graceful-shutdown" class="sidebar-link">Graceful Shutdown</a></li><li class="sidebar-sub-header"><a href="/athenaeum/archive/current/core/usage/exceptions.html#onward" class="sidebar-link">Onward</a></li></ul></li><li><a href="/athenaeum/archive/current/core/usage/ext.html" class="sidebar-link">Extending Core Application</a></li><li><a href="/athenaeum/archive/current/core/usage/testing.html" class="sidebar-link">Testing</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Dto</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Events</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Http</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Properties</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Service</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Support</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Testing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Utils</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="exception-handling"><a href="#exception-handling" class="header-anchor">#</a> Exception Handling</h1> <p>Presumably, your legacy application already has some kind of <a href="https://www.php.net/manual/en/function.set-error-handler.php" target="_blank" rel="noopener noreferrer">error<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.php.net/manual/en/function.set-exception-handler.php" target="_blank" rel="noopener noreferrer">exception<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://www.php.net/manual/en/function.register-shutdown-function.php" target="_blank" rel="noopener noreferrer">shutdown handling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>[1].
Therefore, <strong>exception handling in Athenaeum Core Application is disabled, by default</strong>.
Should you not be happy with your existing solution, then perhaps the possibilities offered here, could prove beneficial.
At the very least, it might give you some inspiration.</p> <p></p><div class="table-of-contents"><ul><li><a href="#laravel-s-exception-handling">Laravel's Exception Handling?</a></li><li><a href="#how-it-works">How it Works</a><ul><li><a href="#error-shutdown-handling">Error &amp; Shutdown Handling</a></li></ul></li><li><a href="#prerequisite">Prerequisite</a></li><li><a href="#enabling-exception-handling">Enabling Exception Handling</a></li><li><a href="#last-resort-handler">&quot;Last Resort&quot; Handler</a><ul><li><a href="#register-your-exception-handler">Register Your Exception Handler</a></li></ul></li><li><a href="#reporting">Reporting</a><ul><li><a href="#don-t-report">Don't Report</a></li></ul></li><li><a href="#handler-in-action">Handler In Action</a><ul><li><a href="#application-didn-t-terminate">Application didn't Terminate</a></li></ul></li><li><a href="#graceful-shutdown">Graceful Shutdown</a><ul><li><a href="#encapsulate-logic-via-run">Encapsulate logic via run()</a></li><li><a href="#avoid-using-terminating">Avoid using terminating()?</a></li><li><a href="#use-handles-to-cleanup">Use Handles to Cleanup</a></li></ul></li><li><a href="#onward">Onward</a></li></ul></div><p></p> <p>[1]: <em>Error, exception and shutdown handling will be referred to as &quot;exception handling&quot;, within this context.</em></p> <h2 id="laravel-s-exception-handling"><a href="#laravel-s-exception-handling" class="header-anchor">#</a> Laravel's Exception Handling?</h2> <p>In the <a href="/athenaeum/archive/current/core/#limitations">limitations section</a>, it has been mentioned that the Athenaeum Core Application does not offer Http Request / Response Handling.
Since Laravel's <a href="https://laravel.com/docs/7.x/errors#the-exception-handler" target="_blank" rel="noopener noreferrer">Error &amp; Exception Handling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> mechanism depends on a Http Request and Response, it cannot be used directly with this application.
More specifically, the <code>render()</code> method, in Laravel's <a href="https://github.com/laravel/framework/blob/6.x/src/Illuminate/Contracts/Debug/ExceptionHandler.php" target="_blank" rel="noopener noreferrer">Exception Handler<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, requires a request and must return a response.
Such cannot be satisfied by the Athenaeum Core Application.
Therefore, a different mechanism is offered - <em>it is still inspired by that of Laravel!</em></p> <h2 id="how-it-works"><a href="#how-it-works" class="header-anchor">#</a> How it Works</h2> <p>This exception handling mechanism uses a pseudo <a href="https://designpatternsphp.readthedocs.io/en/latest/Structural/Composite/README.html" target="_blank" rel="noopener noreferrer">Composite Pattern<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, where a captured exception is passed through a series of &quot;leaf&quot; exception handlers.
The first handler to return <code>true</code>, will stop the process and the exception is considered handled.</p> <p>Behind the scene, a <code>CompositeExceptionHandler</code> is responsible for reporting (<em>e.g. logging</em>) and passing captured exceptions to the registered exception handlers.</p> <div class="language- extra-class"><pre class="language-text"><code>        Captured Exception
                +
+-----------+   |
| Handler A |   |
+-----------+   |
| Handler B |   |
+-----------+   |
| Handler C |   |
+-----------+   |
  ...           |
+-----------+   v
| Handler X |
+-----------+
</code></pre></div><p>This kind of approach allows you to split your application's exception handling, into multiple smaller sections of logic (<em>&quot;leaf&quot; exception handlers</em>).
Each of these handlers will, <em>ideally</em>, only be responsible for dealing with a few exceptions, in contrast to a single large and complex exception handler.</p> <h3 id="error-shutdown-handling"><a href="#error-shutdown-handling" class="header-anchor">#</a> Error &amp; Shutdown Handling</h3> <p>Whenever a PHP <a href="https://www.php.net/manual/en/language.errors.php" target="_blank" rel="noopener noreferrer">error<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> has been captured, it will be wrapped into an <a href="https://www.php.net/manual/en/class.errorexception" target="_blank" rel="noopener noreferrer"><code>ErrorException</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and thrown.
The exception handling mechanism will then capture and process that exception.
Similar logic is applied during PHP's shutdown, in case that an error was encountered.</p> <h2 id="prerequisite"><a href="#prerequisite" class="header-anchor">#</a> Prerequisite</h2> <p>This exception handling mechanism depends on Laravel's <a href="https://packagist.org/packages/illuminate/log" target="_blank" rel="noopener noreferrer">Log<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>[2] package, as means of default reporting.
See <a href="/athenaeum/archive/current/core/usage/logging.html">Logging chapter</a> for how to install it.</p> <h2 id="enabling-exception-handling"><a href="#enabling-exception-handling" class="header-anchor">#</a> Enabling Exception Handling</h2> <p>To enable exception handling, edit your <code>.env</code> and set the <code>EXCEPTION_HANDLING_ENABLED</code> to <code>true</code>.</p> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token comment"># ... previous not shown ...</span>

<span class="token comment"># Exception Handling</span>
<span class="token constant">EXCEPTION_HANDLING_ENABLED</span><span class="token attr-value"><span class="token punctuation">=</span>true</span>
</code></pre></div><h2 id="last-resort-handler"><a href="#last-resort-handler" class="header-anchor">#</a> &quot;Last Resort&quot; Handler</h2> <p>The first &quot;leaf&quot; exception handler that you <em>SHOULD</em> create, is a &quot;Last resort&quot; exception handler;
a handler that deals with any kind of exceptions, aka. your fallback mechanism.</p> <p>To create a &quot;lead&quot; exception handler, extend the <code>BaseExceptionHandler</code> abstraction.
In the following example, a very simplified &quot;last resort&quot; exception handler is shown.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">Acme<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>Handlers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Aedart<span class="token punctuation">\</span>Core<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>BaseExceptionHandler</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Throwable</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LastResortExceptionHandler</span> <span class="token keyword">extends</span> <span class="token class-name">BaseExceptionHandler</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * @inheritDoc
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>Throwable <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">:</span> bool
    <span class="token punctuation">{</span>
        <span class="token comment">// When application is handling a Http request...</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">runningInConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">echo</span> <span class="token single-quoted-string string">'&lt;h1&gt;Sorry... but it seems we have some trouble in our end.&lt;/h1&gt;'</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// When running in console, just output entire exception</span>
        <span class="token keyword">echo</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token variable">$exception</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>If at all possible, you <em>should avoid sending output directly</em> via your exception handlers.
Consider assigning your desired Http output to a response handler, if such is possible for you.
In any case, when creating an exception handler, you should try to accommodate the possibility that your application might be running in the console.
This may require a different kind of exception handling.</p> <h3 id="register-your-exception-handler"><a href="#register-your-exception-handler" class="header-anchor">#</a> Register Your Exception Handler</h3> <p>Once your &quot;leaf&quot; exception handler has been completed, add it's class path in the <code>handlers</code> array, which is located in the <code>/configs/exceptions.php</code> file.</p> <div class="language-php extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">return</span> <span class="token punctuation">[</span>

    <span class="token comment">// ... previous not shown ...</span>

    <span class="token single-quoted-string string">'handlers'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>EditorExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>ShoppingExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>NavigationExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>DbExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>LastResortExceptionHandler</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span></code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Your &quot;last resort&quot; exception handler <em>SHOULD</em> be placed last, in the <code>handlers</code> array.</p></div> <h2 id="reporting"><a href="#reporting" class="header-anchor">#</a> Reporting</h2> <p>By default, an exception is &quot;reported&quot; by the <code>CompositeExceptionHandler</code>, before it is passed through to the registered &quot;leaf&quot; exception handlers.
Within this context, the term reporting means logging exceptions.</p> <h3 id="don-t-report"><a href="#don-t-report" class="header-anchor">#</a> Don't Report</h3> <p>Just like in Laravel's exception handler, if you wish to disable reporting of certain exceptions, add their class paths in the <code>$dontReport</code> property.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name">NavigationExceptionHandler</span> <span class="token keyword">extends</span> <span class="token class-name">BaseExceptionHandler</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * List of exceptions not to be reported
     * 
     * @var string[] 
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">array</span> <span class="token variable">$dontReport</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        \<span class="token package">Acme<span class="token punctuation">\</span>Routing<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>RouteNotFoundException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        \<span class="token package">Acme<span class="token punctuation">\</span>Routing<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>FileDoesNotExistException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>Throwable <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">:</span> bool
    <span class="token punctuation">{</span>
        <span class="token comment">// ... not shown ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h2 id="handler-in-action"><a href="#handler-in-action" class="header-anchor">#</a> Handler In Action</h2> <p>Imagine that the following entry point encounters a condition, where it must throw an exception.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../vendor/autoload.php'</span><span class="token punctuation">;</span>

<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../bootstrap/app.php'</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... your legacy application's logic</span>

<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasSignedIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>RuntimeException</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'User is not authenticated'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ... etc</span>

<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>The thrown exception is captured and passed through the list of registered &quot;lead&quot; exception handlers, until a handler returns <code>true</code>.
Your &quot;last resort&quot; exception handler <em>SHOULD</em> handle any exception, which isn't handled by other registered handlers.</p> <h3 id="application-didn-t-terminate"><a href="#application-didn-t-terminate" class="header-anchor">#</a> Application didn't Terminate</h3> <p>When exceptions are thrown and PHP's <a href="https://www.php.net/manual/en/function.restore-exception-handler.php" target="_blank" rel="noopener noreferrer">native exception handling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> mechanism kicks in, remaining code is not executed.
In other words, in the above shown example, the last two lines are never reached, should an exception be thrown.
As a consequence of this, any registered termination logic is not executed, by the <code>terminate()</code> method.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// ... previous not shown ...</span>

<span class="token comment">// Never executed, in case of exception thrown...</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p>Ensuring clean and graceful application shutdown, is a common problem for many applications.
In the next section, a possible solution is explored.</p> <h2 id="graceful-shutdown"><a href="#graceful-shutdown" class="header-anchor">#</a> Graceful Shutdown</h2> <p>Depending upon your registered service providers, or application's overall logic, it may require termination and shutdown logic.
For instance, you may require logic that ensures all open database transactions are committed, or perhaps rolled back in case of exceptions.
Or perhaps you may require logic, that closes the current session, file points, or other resources.
A possible solution is to utilise the <code>terminating()</code> method.
It registers callback methods that will be executed, when <code>terminate()</code> is invoked.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// Register callback</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminating</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$session</span> <span class="token operator">=</span> IoCFacade<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tryMake</span><span class="token punctuation">(</span>Session<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$session</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... later in your application ...</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Triggers the registered &quot;terminating&quot; callback method</span>
</code></pre></div><p>Unfortunately, if an exception is thrown, the <code>terminate()</code> method might never be reached.
All of your registered callbacks are therefore not invoked.
This could prove problematic, if your application depends on being able to perform <a href="https://en.wikipedia.org/wiki/Graceful_exit" target="_blank" rel="noopener noreferrer">&quot;graceful shutdown&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> logic.</p> <h3 id="encapsulate-logic-via-run"><a href="#encapsulate-logic-via-run" class="header-anchor">#</a> Encapsulate logic via <code>run()</code></h3> <p>A different solution could be, to encapsulate your legacy application's logic via the <code>run()</code> method.
It accepts a single callback. If the callback should fail, e.g. an exception is thrown, it will be captured by the <code>run()</code> method and passed on to the exception handling mechanism.
Once the exception has been handled, code execution is resumed and the <code>terminate()</code> method is triggered.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../vendor/autoload.php'</span><span class="token punctuation">;</span>

<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../bootstrap/app.php'</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">// E.g. include your legacy application's entry point    </span>
    <span class="token keyword">include</span> <span class="token single-quoted-string string">'my_legacy_app_index.php'</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>If the above shown approach is possible for you to implement, then it could contribute towards allowing graceful shutdown.</p> <h3 id="avoid-using-terminating"><a href="#avoid-using-terminating" class="header-anchor">#</a> Avoid using <code>terminating()</code>?</h3> <p>One could argue that you should avoid registering callbacks, via the <code>terminating()</code> method.
But this might not always be possible.
Imagine that for every request, <em>if all goes well</em>, you application needs to commit open database transactions, before closing it's connection gracefully.
It makes sense to use the <code>terminate()</code>, in order to achieve such.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminating</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$db</span> <span class="token operator">=</span> IoCFacade<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tryMake</span><span class="token punctuation">(</span>Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasOpenTransations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... later in your application ...</span>
<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Terminating callbacks can also be registered in your Service Provider's <a href="https://laravel.com/docs/7.x/providers#the-boot-method" target="_blank" rel="noopener noreferrer">boot method<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// In your service provider</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span>Application <span class="token variable">$app</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">terminating</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$db</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasOpenTransations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="use-handles-to-cleanup"><a href="#use-handles-to-cleanup" class="header-anchor">#</a> Use Handles to Cleanup</h3> <p>Now, if an exception is encountered, then you could use make use of an exception handler;
one which ensures to rollback any open database transactions - <em>or perform other cleanup routines</em> - but avoid actually dealing with any exception!
Any exception would just be passed on to the next registered handler.</p> <div class="language-php extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">Acme<span class="token punctuation">\</span>Db<span class="token punctuation">\</span>Cleanup</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Aedart<span class="token punctuation">\</span>Core<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>CleanupHandler</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RollsBackTransactions</span> <span class="token keyword">extends</span> <span class="token class-name">CleanupHandler</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span>Throwable <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
    <span class="token punctuation">{</span>
        <span class="token variable">$db</span> <span class="token operator">=</span> IoCFacade<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tryMake</span><span class="token punctuation">(</span>Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasOpenTransations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>If such an approach is used, then your <code>handlers</code> array could look something similar, to the below illustrated example.
In the top section of the array, you would place handlers that explicitly deal with application cleanup routines, whereas the middle and bottom section of the array would place handlers that deal with exceptions.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">return</span> <span class="token punctuation">[</span>

    <span class="token comment">// ... previous not shown ...</span>

    <span class="token single-quoted-string string">'handlers'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token comment">// Cleanup         </span>
        Acme\<span class="token package">Db<span class="token punctuation">\</span>Cleanup<span class="token punctuation">\</span>RollsBackTransactions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Session<span class="token punctuation">\</span>Cleanup<span class="token punctuation">\</span>ClosesSessions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Storage<span class="token punctuation">\</span>Cleanup<span class="token punctuation">\</span>RemovesFileLock</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>

        <span class="token comment">// Handles exceptions</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>EditorExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>ShoppingExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>NavigationExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>DbExceptions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>

        <span class="token comment">// Last resort - if all else fails...</span>
        Acme\<span class="token package">Exceptions<span class="token punctuation">\</span>Handlers<span class="token punctuation">\</span>LastResortExceptionHandler</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span></code></pre></div><p>Ultimately, the burden of ensuring graceful shutdown falls on your shoulders.
How you go about it, is entirely up to you.
The above illustrated examples is nothing more than a possible solution.</p> <h2 id="onward"><a href="#onward" class="header-anchor">#</a> Onward</h2> <p>Error, exception &amp; shutdown handling is by no means a trivial task.
Perhaps your existing mechanism is sufficient and gets the job done.
If not, perhaps this package's exception handling can offer a suitable alternative.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/aedart/athenaeum/edit/master/docs/archive/current/core/usage/exceptions.md" target="_blank" rel="noopener noreferrer">Edit page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">Tue, 03 Mar 2020 20:54:02 GMT</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/athenaeum/archive/current/core/usage/tasks.html" class="prev">
        Task Scheduling
      </a></span> <span class="next"><a href="/athenaeum/archive/current/core/usage/ext.html">
        Extending Core Application
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/athenaeum/assets/js/app.7535e502.js" defer></script><script src="/athenaeum/assets/js/2.ee1d810c.js" defer></script><script src="/athenaeum/assets/js/36.c8a6a270.js" defer></script>
  </body>
</html>
